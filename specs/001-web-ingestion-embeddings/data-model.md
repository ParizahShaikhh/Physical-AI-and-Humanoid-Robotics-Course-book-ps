# Data Model: Web Content Ingestion and Embeddings

## Overview
This document describes the data models and entities relevant to the website ingestion, embedding, and vector indexing project. It defines the structure of the data as it flows through the ingestion pipeline.

## Key Entities

### Website Content
- **Definition**: Raw content extracted from a website page
- **Attributes**:
  - url: string (source URL of the content)
  - title: string (page title)
  - content: string (clean text content extracted from HTML)
  - metadata: object (additional page metadata)
  - createdAt: datetime (timestamp of extraction)
- **Relationships**: Connected to Text Chunk (one-to-many)

### Text Chunk
- **Definition**: A segment of content that has been processed and prepared for embedding
- **Attributes**:
  - id: string (unique identifier)
  - content: string (chunked text content)
  - sourceUrl: string (URL of the original page)
  - sourceTitle: string (title of the original page)
  - chunkIndex: number (position of this chunk in the original content)
  - createdAt: datetime (timestamp of chunking)
- **Relationships**: Connected to Embedding (one-to-one)

### Embedding
- **Definition**: Vector representation of text content generated by Cohere
- **Attributes**:
  - id: string (unique identifier)
  - vector: array<number> (the embedding vector values)
  - textChunkId: string (reference to the source text chunk)
  - sourceUrl: string (URL of the original page)
  - sourceTitle: string (title of the original page)
  - createdAt: datetime (timestamp of embedding generation)
- **Relationships**: Connected to Vector Record (one-to-one)

### Vector Record
- **Definition**: Entry in Qdrant Cloud containing the embedding with metadata
- **Attributes**:
  - id: string (Qdrant point ID)
  - vector: array<number> (embedding vector)
  - payload: object (metadata including source URL, title, and chunk information)
  - createdAt: datetime (timestamp of storage in Qdrant)
- **Relationships**: Connected to Embedding (one-to-one)

### Crawl Session
- **Definition**: A single execution of the web crawling process
- **Attributes**:
  - id: string (unique identifier)
  - targetUrl: string (root URL that was crawled)
  - status: string (status of the crawl: started, in-progress, completed, failed)
  - pagesProcessed: number (count of pages processed)
  - createdAt: datetime (timestamp of session start)
  - completedAt: datetime (timestamp of session completion)
- **Relationships**: Connected to Website Content (one-to-many)

## Schema Definitions

### Website Content Schema
```json
{
  "url": "https://example.com/page",
  "title": "Page Title",
  "content": "Clean text content extracted from the HTML",
  "metadata": {
    "description": "Page description",
    "keywords": ["keyword1", "keyword2"],
    "lastModified": "2023-01-01T00:00:00Z"
  },
  "createdAt": "2023-01-01T00:00:00Z"
}
```

### Text Chunk Schema
```json
{
  "id": "chunk-uuid",
  "content": "Text content of this chunk (max 2000 characters)",
  "sourceUrl": "https://example.com/page",
  "sourceTitle": "Page Title",
  "chunkIndex": 0,
  "createdAt": "2023-01-01T00:00:00Z"
}
```

### Embedding Schema
```json
{
  "id": "embedding-uuid",
  "vector": [0.1, 0.3, 0.5, ...], // Array of float values
  "textChunkId": "chunk-uuid",
  "sourceUrl": "https://example.com/page",
  "sourceTitle": "Page Title",
  "createdAt": "2023-01-01T00:00:00Z"
}
```

### Vector Record Schema (Qdrant Payload)
```json
{
  "id": "qdrant-point-id",
  "vector": [0.1, 0.3, 0.5, ...],
  "payload": {
    "source_url": "https://example.com/page",
    "source_title": "Page Title",
    "text_chunk_id": "chunk-uuid",
    "content": "First few words of the chunk...",
    "created_at": "2023-01-01T00:00:00Z"
  },
  "createdAt": "2023-01-01T00:00:00Z"
}
```

### Crawl Session Schema
```json
{
  "id": "session-uuid",
  "targetUrl": "https://example.com",
  "status": "completed",
  "pagesProcessed": 100,
  "createdAt": "2023-01-01T00:00:00Z",
  "completedAt": "2023-01-01T01:00:00Z"
}
```

## Validation Rules
- All URLs must be valid and accessible
- Text chunks must be between 100 and 2000 characters
- Embedding vectors must match Cohere's expected dimensions
- All timestamps must be in ISO 8601 format
- Source metadata must be preserved through the pipeline